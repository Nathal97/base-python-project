"""Check if a host is in the Google Chrome HSTS Preload list"""

import functools
import os
import typing

__version__ = "2024.9.1"
__checksum__ = "ef4e3eab5220d793a108b7d223cee6164dc0be09bdc38a15331c3e6efe84a782"
__all__ = ["in_hsts_preload"]

# fmt: off
_GTLD_INCLUDE_SUBDOMAINS = {b'amazon', b'android', b'app', b'audible', b'azure', b'bank', b'bing', b'boo', b'channel', b'chrome', b'dad', b'day', b'dev', b'eat', b'esq', b'fire', b'fly', b'foo', b'fujitsu', b'gle', b'gmail', b'google', b'hangout', b'hotmail', b'imdb', b'ing', b'insurance', b'kindle', b'meet', b'meme', b'microsoft', b'mov', b'new', b'nexus', b'office', b'page', b'phd', b'play', b'prime', b'prof', b'rsvp', b'search', b'silk', b'skype', b'windows', b'xbox', b'xn--cckwcxetd', b'xn--jlq480n2rg', b'youtube', b'zappos', b'zip'}  # noqa: E501
_JUMPTABLE = [[(0, 11), (11, 5), (16, 19), (35, 55), (90, 26), (116, 12), None, (128, 19), (147, 22), (169, 7), (176, 13), (189, 18), None, (207, 29), (236, 37), (273, 19), (292, 9), (301, 36), (337, 24), (361, 10), (371, 18), None, (389, 62), (451, 8), (459, 22), (481, 19), (500, 13), (513, 14), (527, 21), None, None, (548, 40), (588, 20), (608, 25), (633, 22), (655, 22), (677, 28), None, (705, 15), (720, 25), (745, 8), (753, 13), (766, 10), None, (776, 17), (793, 6), (799, 19), (818, 16), (834, 5), (839, 19), (858, 14), (872, 11), (883, 18), (901, 27), (928, 7), (935, 11), (946, 15), (961, 12), (973, 20), (993, 8), (1001, 27), (1028, 46), (1074, 25), (1099, 16), (1115, 8), (1123, 5), (1128, 22), (1150, 18), None, (1168, 36), (1204, 15), (1219, 24), (1243, 11), None, (1254, 10), (1264, 23), (1287, 18), (1305, 18), None, (1323, 20), (1343, 26), (1369, 27), (1396, 28), (1424, 20), (1444, 59), (1503, 14), (1517, 14), (1531, 8), (1539, 8), (1547, 10), (1557, 13), (1570, 20), (1590, 19), None, (1609, 13), (1622, 26), (1648, 11), (1659, 4), (1663, 22), (1685, 19), (1704, 21), (1725, 14), (1739, 28), (1767, 11), (1778, 10), (1788, 12), (1800, 25), None, (1825, 19), (1844, 14), (1858, 26), (1884, 45), (1929, 15), None, (1944, 11), (1955, 30), (1985, 21), (2006, 26), (2032, 6), (2038, 6), (2044, 14), (2058, 5), (2063, 30), (2093, 23), (2116, 6), (2122, 17), (2139, 8), (2147, 12), (2159, 12), (2171, 70), (2241, 55), (2296, 12), (2308, 23), (2331, 16), (2347, 29), (2376, 9), (2385, 24), (2409, 44), (2453, 6), (2459, 41), (2500, 22), (2522, 23), (2545, 31), (2576, 20), (2596, 8), (2604, 15), (2619, 12), (2631, 32), (2663, 25), (2688, 15), None, (2703, 46), (2749, 21), (2770, 17), (2787, 18), (2805, 26), (2831, 5), (2836, 37), (2873, 39), (2912, 16), (2928, 33), (2961, 17), (2978, 23), (3001, 21), (3022, 25), (3047, 19), (3066, 14), (3080, 7), (3087, 37), None, (3124, 18), (3142, 21), (3163, 20), (3183, 17), (3200, 24), (3224, 12), (3236, 36), (3272, 35), (3307, 12), (3319, 57), (3376, 25), (3401, 32), None, (3433, 8), (3441, 25), (3466, 18), (3484, 6), (3490, 23), None, (3513, 36), (3549, 33), (3582, 14), (3596, 16), (3612, 22), None, (3634, 30), (3664, 41), (3705, 50), (3755, 15), (3770, 20), (3790, 31), (3821, 21), (3842, 32), (3874, 24), (3898, 20), (3918, 17), (3935, 52), (3987, 6), (3993, 9), (4002, 12), (4014, 18), (4032, 11), (4043, 10), (4053, 39), (4092, 42), None, (4134, 36), (4170, 17), None, (4187, 8), (4195, 8), (4203, 17), None, (4220, 25), (4245, 17), None, (4262, 21), (4283, 35), (4318, 21), (4339, 10), (4349, 48), (4397, 11), (4408, 37), (4445, 41), (4486, 19), (4505, 12), (4517, 14), (4531, 23), (4554, 29), (4583, 14), (4597, 8), (4605, 47), (4652, 52), None, None, (4704, 47), (4751, 42), None, (4793, 18), None, (4811, 15), (4826, 8), (4834, 21), (4855, 6), (4861, 29), (4890, 22)], [(4912, 8596), (13508, 8279), (21787, 8937), (30724, 8677), (39401, 8283), (47684, 8558), (56242, 9010), (65252, 8233), (73485, 8338), (81823, 8061), (89884, 8639), (98523, 7862), (106385, 8470), (114855, 9297), (124152, 8499), (132651, 9292), (141943, 9337), (151280, 8031), (159311, 8798), (168109, 7693), (175802, 8767), (184569, 8271), (192840, 8551), (201391, 9002), (210393, 8783), (219176, 8247), (227423, 8927), (236350, 9735), (246085, 8258), (254343, 8166), (262509, 9005), (271514, 8560), (280074, 8665), (288739, 8851), (297590, 8241), (305831, 8983), (314814, 8773), (323587, 9414), (333001, 8830), (341831, 8925), (350756, 9000), (359756, 7876), (367632, 8496), (376128, 8434), (384562, 8211), (392773, 8702), (401475, 8168), (409643, 9882), (419525, 8294), (427819, 8001), (435820, 8569), (444389, 8166), (452555, 8465), (461020, 8596), (469616, 8279), (477895, 8587), (486482, 8514), (494996, 8904), (503900, 8584), (512484, 7530), (520014, 7932), (527946, 8824), (536770, 8695), (545465, 8998), (554463, 9466), (563929, 8190), (572119, 8493), (580612, 9120), (589732, 9445), (599177, 8304), (607481, 7970), (615451, 8120), (623571, 7805), (631376, 9055), (640431, 8199), (648630, 8883), (657513, 8174), (665687, 9488), (675175, 8677), (683852, 8494), (692346, 8449), (700795, 7848), (708643, 8317), (716960, 8633), (725593, 8519), (734112, 8845), (742957, 9184), (752141, 8346), (760487, 7827), (768314, 8535), (776849, 9832), (786681, 8696), (795377, 8106), (803483, 8580), (812063, 8522), (820585, 8517), (829102, 8637), (837739, 7900), (845639, 8602), (854241, 7846), (862087, 8334), (870421, 8068), (878489, 8441), (886930, 8079), (895009, 8268), (903277, 9304), (912581, 8806), (921387, 9023), (930410, 8209), (938619, 8288), (946907, 9201), (956108, 8582), (964690, 7902), (972592, 7980), (980572, 8436), (989008, 8518), (997526, 8700), (1006226, 8914), (1015140, 8573), (1023713, 8416), (1032129, 8714), (1040843, 8570), (1049413, 8201), (1057614, 8563), (1066177, 8991), (1075168, 8144), (1083312, 8364), (1091676, 9361), (1101037, 8212), (1109249, 9700), (1118949, 9493), (1128442, 8611), (1137053, 8124), (1145177, 7796), (1152973, 8136), (1161109, 9230), (1170339, 9285), (1179624, 9641), (1189265, 8829), (1198094, 9005), (1207099, 9398), (1216497, 8909), (1225406, 8578), (1233984, 8682), (1242666, 9453), (1252119, 7641), (1259760, 8689), (1268449, 8324), (1276773, 8411), (1285184, 8481), (1293665, 8521), (1302186, 8709), (1310895, 8532), (1319427, 8070), (1327497, 8249), (1335746, 8732), (1344478, 8666), (1353144, 8671), (1361815, 8167), (1369982, 7966), (1377948, 8193), (1386141, 8576), (1394717, 8637), (1403354, 8266), (1411620, 8682), (1420302, 9302), (1429604, 9555), (1439159, 8034), (1447193, 9683), (1456876, 8549), (1465425, 8476), (1473901, 8488), (1482389, 9221), (1491610, 8201), (1499811, 8255), (1508066, 8487), (1516553, 9016), (1525569, 9020), (1534589, 8173), (1542762, 7881), (1550643, 10599), (1561242, 9231), (1570473, 8023), (1578496, 8424), (1586920, 8823), (1595743, 8918), (1604661, 7915), (1612576, 9243), (1621819, 8399), (1630218, 8662), (1638880, 8531), (1647411, 8312), (1655723, 8448), (1664171, 7702), (1671873, 8467), (1680340, 7820), (1688160, 7776), (1695936, 8129), (1704065, 8442), (1712507, 9070), (1721577, 8665), (1730242, 8740), (1738982, 8942), (1747924, 7692), (1755616, 8974), (1764590, 9151), (1773741, 8041), (1781782, 8758), (1790540, 9628), (1800168, 8118), (1808286, 9369), (1817655, 8791), (1826446, 8182), (1834628, 8447), (1843075, 8738), (1851813, 8693), (1860506, 8317), (1868823, 8560), (1877383, 8457), (1885840, 9204), (1895044, 8450), (1903494, 7917), (1911411, 9068), (1920479, 8473), (1928952, 8637), (1937589, 8386), (1945975, 9373), (1955348, 8929), (1964277, 8847), (1973124, 9265), (1982389, 9267), (1991656, 8588), (2000244, 8392), (2008636, 8853), (2017489, 8383), (2025872, 9426), (2035298, 8529), (2043827, 7944), (2051771, 7863), (2059634, 9036), (2068670, 9195), (2077865, 8767), (2086632, 8716), (2095348, 8855), (2104203, 8226), (2112429, 9284), (2121713, 8730), (2130443, 8384), (2138827, 8682), (2147509, 7694), (2155203, 8529), (2163732, 8523), (2172255, 8288), (2180543, 8121), (2188664, 8397), (2197061, 8773)], [(2205834, 910), (2206744, 798), (2207542, 886), (2208428, 811), (2209239, 894), (2210133, 799), (2210932, 651), (2211583, 923), (2212506, 664), (2213170, 902), (2214072, 454), (2214526, 675), (2215201, 908), (2216109, 1036), (2217145, 833), (2217978, 707), (2218685, 1280), (2219965, 782), (2220747, 794), (2221541, 848), (2222389, 1174), (2223563, 764), (2224327, 778), (2225105, 740), (2225845, 755), (2226600, 818), (2227418, 924), (2228342, 1350), (2229692, 790), (2230482, 760), (2231242, 811), (2232053, 745), (2232798, 786), (2233584, 812), (2234396, 1030), (2235426, 1070), (2236496, 583), (2237079, 848), (2237927, 779), (2238706, 978), (2239684, 843), (2240527, 761), (2241288, 697), (2241985, 839), (2242824, 852), (2243676, 839), (2244515, 721), (2245236, 808), (2246044, 841), (2246885, 600), (2247485, 780), (2248265, 787), (2249052, 820), (2249872, 847), (2250719, 1356), (2252075, 716), (2252791, 862), (2253653, 770), (2254423, 628), (2255051, 788), (2255839, 896), (2256735, 856), (2257591, 1015), (2258606, 849), (2259455, 760), (2260215, 803), (2261018, 943), (2261961, 701), (2262662, 614), (2263276, 1063), (2264339, 856), (2265195, 710), (2265905, 450), (2266355, 789), (2267144, 431), (2267575, 804), (2268379, 641), (2269020, 950), (2269970, 901), (2270871, 631), (2271502, 870), (2272372, 832), (2273204, 944), (2274148, 777), (2274925, 967), (2275892, 925), (2276817, 758), (2277575, 606), (2278181, 889), (2279070, 944), (2280014, 1152), (2281166, 1171), (2282337, 972), (2283309, 775), (2284084, 728), (2284812, 569), (2285381, 1015), (2286396, 831), (2287227, 774), (2288001, 747), (2288748, 828), (2289576, 795), (2290371, 794), (2291165, 548), (2291713, 799), (2292512, 952), (2293464, 652), (2294116, 594), (2294710, 833), (2295543, 1005), (2296548, 853), (2297401, 1007), (2298408, 1076), (2299484, 746), (2300230, 715), (2300945, 749), (2301694, 759), (2302453, 905), (2303358, 659), (2304017, 746), (2304763, 1106), (2305869, 759), (2306628, 931), (2307559, 824), (2308383, 908), (2309291, 834), (2310125, 876), (2311001, 855), (2311856, 637), (2312493, 966), (2313459, 780), (2314239, 986), (2315225, 758), (2315983, 704), (2316687, 666), (2317353, 913), (2318266, 933), (2319199, 711), (2319910, 642), (2320552, 866), (2321418, 838), (2322256, 716), (2322972, 748), (2323720, 677), (2324397, 783), (2325180, 642), (2325822, 863), (2326685, 669), (2327354, 848), (2328202, 712), (2328914, 822), (2329736, 655), (2330391, 825), (2331216, 943), (2332159, 1052), (2333211, 885), (2334096, 822), (2334918, 1057), (2335975, 907), (2336882, 763), (2337645, 1098), (2338743, 734), (2339477, 964), (2340441, 939), (2341380, 1097), (2342477, 1116), (2343593, 686), (2344279, 958), (2345237, 729), (2345966, 679), (2346645, 831), (2347476, 540), (2348016, 1213), (2349229, 656), (2349885, 1035), (2350920, 868), (2351788, 1006), (2352794, 821), (2353615, 645), (2354260, 745), (2355005, 1965), (2356970, 852), (2357822, 879), (2358701, 829), (2359530, 1054), (2360584, 652), (2361236, 932), (2362168, 941), (2363109, 614), (2363723, 1013), (2364736, 667), (2365403, 630), (2366033, 562), (2366595, 1154), (2367749, 802), (2368551, 754), (2369305, 735), (2370040, 701), (2370741, 982), (2371723, 917), (2372640, 879), (2373519, 852), (2374371, 876), (2375247, 714), (2375961, 702), (2376663, 717), (2377380, 748), (2378128, 1031), (2379159, 938), (2380097, 824), (2380921, 821), (2381742, 743), (2382485, 852), (2383337, 1137), (2384474, 553), (2385027, 849), (2385876, 798), (2386674, 806), (2387480, 742), (2388222, 627), (2388849, 641), (2389490, 866), (2390356, 874), (2391230, 1029), (2392259, 585), (2392844, 687), (2393531, 751), (2394282, 721), (2395003, 814), (2395817, 821), (2396638, 988), (2397626, 553), (2398179, 1081), (2399260, 697), (2399957, 748), (2400705, 792), (2401497, 909), (2402406, 618), (2403024, 920), (2403944, 970), (2404914, 855), (2405769, 528), (2406297, 906), (2407203, 671), (2407874, 973), (2408847, 576), (2409423, 782), (2410205, 895), (2411100, 721), (2411821, 924), (2412745, 2373), (2415118, 692), (2415810, 898), (2416708, 803), (2417511, 889), (2418400, 730)], [(2419130, 48), None, None, (2419178, 42), None, (2419220, 27), (2419247, 43), None, None, None, None, None, None, None, (2419290, 21), None, None, (2419311, 42), None, (2419353, 25), (2419378, 44), None, (2419422, 49), None, None, (2419471, 23), None, None, None, None, None, None, (2419494, 21), (2419515, 46), None, None, (2419561, 44), None, None, None, None, (2419605, 44), (2419649, 21), (2419670, 23), None, None, None, None, (2419693, 42), None, None, None, None, None, (2419735, 31), None, None, None, None, (2419766, 42), (2419808, 19), None, None, (2419827, 21), None, (2419848, 26), (2419874, 56), None, (2419930, 16), (2419946, 42), (2419988, 27), None, None, None, None, (2420015, 21), (2420036, 52), None, (2420088, 17), (2420105, 20), (2420125, 42), None, None, None, (2420167, 25), (2420192, 17), (2420209, 27), (2420236, 21), None, None, None, (2420257, 24), None, (2420281, 24), (2420305, 21), (2420326, 24), None, (2420350, 48), None, None, (2420398, 17), (2420415, 19), None, None, None, None, (2420434, 31), None, None, None, None, None, None, (2420465, 28), None, (2420493, 42), (2420535, 42), (2420577, 17), (2420594, 17), (2420611, 26), None, (2420637, 19), None, None, None, None, (2420656, 20), None, None, (2420676, 42), (2420718, 63), (2420781, 17), None, None, (2420798, 21), None, None, None, None, (2420819, 21), (2420840, 16), None, (2420856, 31), None, None, None, None, (2420887, 42), None, (2420929, 80), None, (2421009, 9), None, (2421018, 21), (2421039, 42), None, (2421081, 18), (2421099, 90), (2421189, 56), (2421245, 45), None, (2421290, 42), None, None, (2421332, 24), (2421356, 21), None, None, None, None, None, (2421377, 42), (2421419, 21), (2421440, 21), None, (2421461, 42), (2421503, 25), None, (2421528, 55), (2421583, 21), (2421604, 42), None, None, (2421646, 36), (2421682, 16), None, None, (2421698, 16), None, (2421714, 35), None, None, (2421749, 21), None, (2421770, 22), (2421792, 21), (2421813, 21), (2421834, 21), None, (2421855, 63), (2421918, 41), (2421959, 39), (2421998, 42), None, None, None, None, None, (2422040, 15), (2422055, 21), (2422076, 21), None, None, (2422097, 21), None, None, (2422118, 21), None, None, (2422139, 19), (2422158, 66), None, None, None, (2422224, 50), None, (2422274, 21), (2422295, 21), (2422316, 19), None, (2422335, 16), (2422351, 26), None, (2422377, 58), (2422435, 42), None, None, None, None, None, None, (2422477, 21), None, None, None, (2422498, 21), None, None, (2422519, 64), None, (2422583, 254), (2422837, 21), (2422858, 24), None, (2422882, 21), (2422903, 29)], [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, (2422932, 62), None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None]]  # noqa: E501
_CRC8_TABLE = [
    0x00, 0x07, 0x0e, 0x09, 0x1c, 0x1b, 0x12, 0x15,
    0x38, 0x3f, 0x36, 0x31, 0x24, 0x23, 0x2a, 0x2d,
    0x70, 0x77, 0x7e, 0x79, 0x6c, 0x6b, 0x62, 0x65,
    0x48, 0x4f, 0x46, 0x41, 0x54, 0x53, 0x5a, 0x5d,
    0xe0, 0xe7, 0xee, 0xe9, 0xfc, 0xfb, 0xf2, 0xf5,
    0xd8, 0xdf, 0xd6, 0xd1, 0xc4, 0xc3, 0xca, 0xcd,
    0x90, 0x97, 0x9e, 0x99, 0x8c, 0x8b, 0x82, 0x85,
    0xa8, 0xaf, 0xa6, 0xa1, 0xb4, 0xb3, 0xba, 0xbd,
    0xc7, 0xc0, 0xc9, 0xce, 0xdb, 0xdc, 0xd5, 0xd2,
    0xff, 0xf8, 0xf1, 0xf6, 0xe3, 0xe4, 0xed, 0xea,
    0xb7, 0xb0, 0xb9, 0xbe, 0xab, 0xac, 0xa5, 0xa2,
    0x8f, 0x88, 0x81, 0x86, 0x93, 0x94, 0x9d, 0x9a,
    0x27, 0x20, 0x29, 0x2e, 0x3b, 0x3c, 0x35, 0x32,
    0x1f, 0x18, 0x11, 0x16, 0x03, 0x04, 0x0d, 0x0a,
    0x57, 0x50, 0x59, 0x5e, 0x4b, 0x4c, 0x45, 0x42,
    0x6f, 0x68, 0x61, 0x66, 0x73, 0x74, 0x7d, 0x7a,
    0x89, 0x8e, 0x87, 0x80, 0x95, 0x92, 0x9b, 0x9c,
    0xb1, 0xb6, 0xbf, 0xb8, 0xad, 0xaa, 0xa3, 0xa4,
    0xf9, 0xfe, 0xf7, 0xf0, 0xe5, 0xe2, 0xeb, 0xec,
    0xc1, 0xc6, 0xcf, 0xc8, 0xdd, 0xda, 0xd3, 0xd4,
    0x69, 0x6e, 0x67, 0x60, 0x75, 0x72, 0x7b, 0x7c,
    0x51, 0x56, 0x5f, 0x58, 0x4d, 0x4a, 0x43, 0x44,
    0x19, 0x1e, 0x17, 0x10, 0x05, 0x02, 0x0b, 0x0c,
    0x21, 0x26, 0x2f, 0x28, 0x3d, 0x3a, 0x33, 0x34,
    0x4e, 0x49, 0x40, 0x47, 0x52, 0x55, 0x5c, 0x5b,
    0x76, 0x71, 0x78, 0x7f, 0x6a, 0x6d, 0x64, 0x63,
    0x3e, 0x39, 0x30, 0x37, 0x22, 0x25, 0x2c, 0x2b,
    0x06, 0x01, 0x08, 0x0f, 0x1a, 0x1d, 0x14, 0x13,
    0xae, 0xa9, 0xa0, 0xa7, 0xb2, 0xb5, 0xbc, 0xbb,
    0x96, 0x91, 0x98, 0x9f, 0x8a, 0x8d, 0x84, 0x83,
    0xde, 0xd9, 0xd0, 0xd7, 0xc2, 0xc5, 0xcc, 0xcb,
    0xe6, 0xe1, 0xe8, 0xef, 0xfa, 0xfd, 0xf4, 0xf3
]
# fmt: on

_IS_LEAF = 0x80
_INCLUDE_SUBDOMAINS = 0x40


try:
    from importlib.resources import open_binary

    def open_pkg_binary(path: str) -> typing.BinaryIO:
        return open_binary("hstspreload", path)


except ImportError:

    def open_pkg_binary(path: str) -> typing.BinaryIO:
        return open(
            os.path.join(os.path.dirname(os.path.abspath(__file__)), path),
            "rb",
        )


@functools.lru_cache(maxsize=1024)
def in_hsts_preload(host: typing.AnyStr) -> bool:
    """Determines if an IDNA-encoded host is on the HSTS preload list"""

    if isinstance(host, str):
        host = host.encode("ascii")
    labels = host.lower().split(b".")

    # Fast-branch for gTLDs that are registered to preload all sub-domains.
    if labels[-1] in _GTLD_INCLUDE_SUBDOMAINS:
        return True

    with open_pkg_binary("hstspreload.bin") as f:
        for layer, label in enumerate(labels[::-1]):
            # None of our layers are greater than 5 deep.
            if layer > 4:
                return False

            # Read the jump table for the layer and label
            jump_info = _JUMPTABLE[layer][_crc8(label)]
            if jump_info is None:
                # No entry: host is not preloaded
                return False

            # Read the set of entries for that layer and label
            f.seek(jump_info[0])
            data = bytearray(jump_info[1])
            f.readinto(data)

            for is_leaf, include_subdomains, ent_label in _iter_entries(data):
                # We found a potential leaf
                if is_leaf:
                    if ent_label == host:
                        return True
                    if include_subdomains and host.endswith(b"." + ent_label):
                        return True

                # Continue traversing as we're not at a leaf.
                elif label == ent_label:
                    break
            else:
                return False
    return False


def _iter_entries(data: bytes) -> typing.Iterable[typing.Tuple[int, int, bytes]]:
    while data:
        flags = data[0]
        size = data[1]
        label = bytes(data[2 : 2 + size])
        yield (flags & _IS_LEAF, flags & _INCLUDE_SUBDOMAINS, label)
        data = data[2 + size :]


def _crc8(value: bytes) -> int:
    # CRC8 reference implementation: https://github.com/niccokunzmann/crc8
    checksum = 0x00
    for byte in value:
        checksum = _CRC8_TABLE[checksum ^ byte]
    return checksum
